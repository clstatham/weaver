@startup
system setup {
    create_player(100)
    create_player(100)
}

impl Player {
    func default() -> Player {
        return Player {
            pos: vec3(0, 0, 0),
            vel: vec3(0, 0, 0),
            rot: Quat.from_axis_angle(vec3(0, 1, 0), 0.0),
        }
    }

    func print(self: Player) {
        print("Player {")
        print("    pos =", self.pos)
        print("    vel =", self.vel)
        print("    rot =", self.rot)
        print("}")
    }
}

func create_player(hp: Int) -> Entity {
    spawn(
        Player.default(),
        Health {
            hp: hp,
        },
    )
}

@update
system update {
    let res time: Time
    time.update()
    let dt = time.delta_seconds
    print("dt =", dt)
    let dt = vec3(dt, dt, dt)

    loop query _ [
        var player: Player,
    ] {
        player.vel += vec3(0, -9.81, 0) * dt
        player.pos += player.vel * dt
        player.print()
    }
}
